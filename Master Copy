# require bio3d package
install.packages(bio3d)
#use function read.pdb to read a pdb file
pdb <- read.pdb("1a52") # read G-protein structure

#use function binding.site to identify a binding site within loaded pdb file
bs <- binding.site(pdb)

#use function print(bs$resnames) to print names of residues involved in indentified binding site
print(bs$resnames) # residue names of identified binding site

#Examples
pdb <- read.pdb("1bzm")
bs <- binding.site(pdb)
print(bs$resnames)

pdb_1 <- read.pdb("1pph")
bs_a <- binding.site(pdb_1)
print(bs_a$resnames)

pdb_2 <- read.pdb("3dfr")
bs_b <- binding.site(pdb_2)
print(bs$resnames)

#select the binding site and trim the pdb file to just the residues in the binding site
inds <- atom.select (pdb, resno = bs$resno)
pdb3 <- trim.pdb(pdb, inds)

write.pdb(pdb3, file= "1bzm_bindingsite.pdb")

blast_search <- blast.pdb(pdb)
print(blast$hit.tbl)
limit_id <- blast$hit.tbl$identity
limit_id
limit_id[limit_id<=60 & limit_id>=50]
