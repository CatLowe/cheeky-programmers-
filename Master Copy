
#read pdb file 
pdb <- read.pdb("1bmz")
blast_search <- blast.pdb(pdb)
print(blast_search$hit.tbl)

#Select the columns of data that we are extracting from the blast search data
identity <- blast_search$hit.tbl$identity
pdbid <- blast_search$hit.tbl$pdb.id

#bind the two columns of data together
result <- cbind(identity,pdbid)
result

#Limit the identity of the blast search to be <=60 and >=50, and just print these
limit <- subset(result,identity<=60 & identity>=50)
limit

#select pdb ids
pdbid_select<-limit[,c("pdbid")]
pdbid_select

#select 5 random pdb files
rdm<-sample(pdbid_rdm, 5)
rdm

#remove chain number 
no_chain<-gsub('.{2}$','',rdm)
no_chain

#read pdb files of BLAST search 
multiple<-lapply(no_chain,read.pdb)

#take binding site from indivisual pdb file
bs<-lapply(multiple, binding.site)
bsoutput_1<-bs[[1]]
bsatoms_1<-atom.select(pdb, resno = bsoutput_1$resno)
binding_1<-trim.pdb(pdb,bsatoms_1)

#write.pdb
write.pdb(binding_1,file = "1SN2_binding_site.pdb")




#FUNCTIONS

limit.pdbids<-function(number)
{number <- length(pdb_ids)
  if(number >5){rdm<-sample(pdb_ids,5)}
  else{limit <- subset(result,identity<=65 & identity>=50)
  pdb_ids <- limit[,c("pdbid")]

  }}
pdb_ids1<-limit.pdbids(pdb_ids)
pdb_ids1
